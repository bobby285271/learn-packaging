From 6912e06d9ab19ba28991b5cab3319d61d856bd6d Mon Sep 17 00:00:00 2001
From: Adam Reichold <adam.reichold@t-online.de>
Date: Tue, 6 Nov 2018 09:00:02 +0100
Subject: [PATCH] Check for stream before calling stream methods when saving an
 embedded file.

Closes #659
Index: poppler-0.68.0/poppler/FileSpec.cc
===================================================================
--- poppler-0.68.0.orig/poppler/FileSpec.cc
+++ poppler-0.68.0/poppler/FileSpec.cc
@@ -93,6 +93,9 @@ GBool EmbFile::save(const char *path) {
 GBool EmbFile::save2(FILE *f) {
   int c;
 
+  if (unlikely(!m_objStr.isStream()))
+    return false;
+
   m_objStr.streamReset();
   while ((c = m_objStr.streamGetChar()) != EOF) {
     fputc(c, f);
