diff -Naur libseccomp-2.3.2-old/include/seccomp.h libseccomp-2.3.2/include/seccomp.h
--- libseccomp-2.3.2-old/include/seccomp.h	2017-02-28 07:19:38.922218201 +0800
+++ libseccomp-2.3.2/include/seccomp.h	2018-02-20 19:06:00.849257606 +0800
@@ -180,6 +180,19 @@
 #define SCMP_ARCH_PPC64LE	AUDIT_ARCH_PPC64LE
 
 /**
+ * The RISC-V architecture tokens.
+ *
+ * RISC-V support for audit is not ready yet.
+ */
+#ifndef AUDIT_ARCH_RISCV64
+#ifndef EM_RISCV
+#define EM_RISCV		243
+#endif /* EM_RISCV64 */
+#define AUDIT_ARCH_RISCV64	(EM_RISCV|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)
+#endif /* AUDIT_ARCH_RISCV64 */
+#define SCMP_ARCH_RISCV64	AUDIT_ARCH_RISCV64
+
+/**
  * The S390 architecture tokens
  */
 #define SCMP_ARCH_S390		AUDIT_ARCH_S390
@@ -1619,6 +1632,16 @@
 #define __NR_pkey_free		__PNR_pkey_free
 #endif /* __NR_pkey_free */
 
+#define __PNR_renameat		-10204
+#ifndef __NR_renameat
+#define __NR_renameat		__PNR_renameat
+#endif /* __NR_renameat */
+
+#define __PNR_riscv_flush_icache	-10205
+#ifndef __NR_riscv_flush_icache
+#define __NR_riscv_flush_icache		__PNR_riscv_flush_icache
+#endif /* __NR_riscv_flush_icache */
+
 #ifdef __cplusplus
 }
 #endif
diff -Naur libseccomp-2.3.2-old/src/arch-aarch64-syscalls.c libseccomp-2.3.2/src/arch-aarch64-syscalls.c
--- libseccomp-2.3.2-old/src/arch-aarch64-syscalls.c	2017-02-24 06:31:31.519778668 +0800
+++ libseccomp-2.3.2/src/arch-aarch64-syscalls.c	2018-02-20 19:06:00.849257606 +0800
@@ -294,6 +294,7 @@
 	{ "renameat2", 276 },
 	{ "request_key", 218 },
 	{ "restart_syscall", 128 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", __PNR_rmdir },
 	{ "rt_sigaction", 134 },
 	{ "rt_sigpending", 136 },
diff -Naur libseccomp-2.3.2-old/src/arch-arm-syscalls.c libseccomp-2.3.2/src/arch-arm-syscalls.c
--- libseccomp-2.3.2-old/src/arch-arm-syscalls.c	2017-02-24 06:31:31.536445366 +0800
+++ libseccomp-2.3.2/src/arch-arm-syscalls.c	2018-02-20 19:06:00.845924233 +0800
@@ -306,6 +306,7 @@
 	{ "renameat2", (__SCMP_NR_BASE + 382) },
 	{ "request_key", (__SCMP_NR_BASE + 310) },
 	{ "restart_syscall", (__SCMP_NR_BASE +  0) },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", (__SCMP_NR_BASE + 40) },
 	{ "rt_sigaction", (__SCMP_NR_BASE + 174) },
 	{ "rt_sigpending", (__SCMP_NR_BASE + 176) },
diff -Naur libseccomp-2.3.2-old/src/arch.c libseccomp-2.3.2/src/arch.c
--- libseccomp-2.3.2-old/src/arch.c	2017-02-28 06:24:22.638360424 +0800
+++ libseccomp-2.3.2/src/arch.c	2018-02-20 19:06:00.842590860 +0800
@@ -40,6 +40,7 @@
 #include "arch-mips64n32.h"
 #include "arch-ppc.h"
 #include "arch-ppc64.h"
+#include "arch-riscv64.h"
 #include "arch-s390.h"
 #include "arch-s390x.h"
 #include "db.h"
@@ -85,6 +86,8 @@
 #endif
 #elif __PPC__
 const struct arch_def *arch_def_native = &arch_def_ppc;
+#elif __riscv && __riscv_xlen == 64
+const struct arch_def *arch_def_native = &arch_def_riscv64;
 #elif __s390x__ /* s390x must be checked before s390 */
 const struct arch_def *arch_def_native = &arch_def_s390x;
 #elif __s390__
@@ -143,6 +146,8 @@
 		return &arch_def_ppc64;
 	case SCMP_ARCH_PPC64LE:
 		return &arch_def_ppc64le;
+	case SCMP_ARCH_RISCV64:
+		return &arch_def_ppc64;
 	case SCMP_ARCH_S390:
 		return &arch_def_s390;
 	case SCMP_ARCH_S390X:
@@ -189,6 +194,8 @@
 		return &arch_def_ppc64;
 	else if (strcmp(arch_name, "ppc64le") == 0)
 		return &arch_def_ppc64le;
+	else if (strcmp(arch_name, "riscv64") == 0)
+		return &arch_def_riscv64;
 	else if (strcmp(arch_name, "s390") == 0)
 		return &arch_def_s390;
 	else if (strcmp(arch_name, "s390x") == 0)
diff -Naur libseccomp-2.3.2-old/src/arch-mips64n32-syscalls.c libseccomp-2.3.2/src/arch-mips64n32-syscalls.c
--- libseccomp-2.3.2-old/src/arch-mips64n32-syscalls.c	2017-02-24 06:31:31.569778761 +0800
+++ libseccomp-2.3.2/src/arch-mips64n32-syscalls.c	2018-02-20 19:06:00.845924233 +0800
@@ -298,6 +298,7 @@
 	{ "renameat2", (__SCMP_NR_BASE + 315) },
 	{ "request_key", (__SCMP_NR_BASE + 244) },
 	{ "restart_syscall", (__SCMP_NR_BASE + 214) },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", (__SCMP_NR_BASE + 82) },
 	{ "rt_sigaction", (__SCMP_NR_BASE + 13) },
 	{ "rt_sigpending", (__SCMP_NR_BASE + 125) },
diff -Naur libseccomp-2.3.2-old/src/arch-mips64-syscalls.c libseccomp-2.3.2/src/arch-mips64-syscalls.c
--- libseccomp-2.3.2-old/src/arch-mips64-syscalls.c	2017-02-24 06:31:31.579778780 +0800
+++ libseccomp-2.3.2/src/arch-mips64-syscalls.c	2018-02-20 19:06:00.845924233 +0800
@@ -298,6 +298,7 @@
 	{ "renameat2", (__SCMP_NR_BASE + 311) },
 	{ "request_key", (__SCMP_NR_BASE + 240) },
 	{ "restart_syscall", (__SCMP_NR_BASE + 213) },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", (__SCMP_NR_BASE + 82) },
 	{ "rt_sigaction", (__SCMP_NR_BASE + 13) },
 	{ "rt_sigpending", (__SCMP_NR_BASE + 125) },
diff -Naur libseccomp-2.3.2-old/src/arch-mips-syscalls.c libseccomp-2.3.2/src/arch-mips-syscalls.c
--- libseccomp-2.3.2-old/src/arch-mips-syscalls.c	2017-02-24 06:31:31.596445478 +0800
+++ libseccomp-2.3.2/src/arch-mips-syscalls.c	2018-02-20 19:06:00.842590860 +0800
@@ -298,6 +298,7 @@
 	{ "renameat2", (__SCMP_NR_BASE + 351) },
 	{ "request_key", (__SCMP_NR_BASE + 281) },
 	{ "restart_syscall", (__SCMP_NR_BASE + 253) },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", (__SCMP_NR_BASE + 40) },
 	{ "rt_sigaction", (__SCMP_NR_BASE + 194) },
 	{ "rt_sigpending", (__SCMP_NR_BASE + 196) },
diff -Naur libseccomp-2.3.2-old/src/arch-ppc64-syscalls.c libseccomp-2.3.2/src/arch-ppc64-syscalls.c
--- libseccomp-2.3.2-old/src/arch-ppc64-syscalls.c	2017-02-24 06:31:31.633112213 +0800
+++ libseccomp-2.3.2/src/arch-ppc64-syscalls.c	2018-02-20 19:06:00.842590860 +0800
@@ -295,6 +295,7 @@
 	{ "renameat2", 357 },
 	{ "request_key", 270 },
 	{ "restart_syscall", 0 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 40 },
 	{ "rt_sigaction", 173 },
 	{ "rt_sigpending", 175 },
diff -Naur libseccomp-2.3.2-old/src/arch-ppc-syscalls.c libseccomp-2.3.2/src/arch-ppc-syscalls.c
--- libseccomp-2.3.2-old/src/arch-ppc-syscalls.c	2017-02-24 06:31:31.646445571 +0800
+++ libseccomp-2.3.2/src/arch-ppc-syscalls.c	2018-02-20 19:06:00.842590860 +0800
@@ -295,6 +295,7 @@
 	{ "renameat2", 357 },
 	{ "request_key", 270 },
 	{ "restart_syscall", 0 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 40 },
 	{ "rt_sigaction", 173 },
 	{ "rt_sigpending", 175 },
diff -Naur libseccomp-2.3.2-old/src/arch-riscv64.c libseccomp-2.3.2/src/arch-riscv64.c
--- libseccomp-2.3.2-old/src/arch-riscv64.c	1970-01-01 08:00:00.000000000 +0800
+++ libseccomp-2.3.2/src/arch-riscv64.c	2018-02-20 19:06:00.849257606 +0800
@@ -0,0 +1,37 @@
+/**
+ * Enhanced Seccomp RISC-V RV64 Syscall Table
+ *
+ * Copyright (c) 2018 Icenowy Zheng <icenowy@aosc.io>
+ */
+
+/*
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of version 2.1 of the GNU Lesser General Public License as
+ * published by the Free Software Foundation.
+ *
+ * This library is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License
+ * for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, see <http://www.gnu.org/licenses>.
+ */
+
+#include <stdlib.h>
+#include <errno.h>
+#include <linux/audit.h>
+
+#include "arch.h"
+#include "arch-riscv64.h"
+
+const struct arch_def arch_def_riscv64 = {
+	.token = SCMP_ARCH_RISCV64,
+	.token_bpf = AUDIT_ARCH_RISCV64,
+	.size = ARCH_SIZE_64,
+	.endian = ARCH_ENDIAN_LITTLE,
+	.syscall_resolve_name = riscv64_syscall_resolve_name,
+	.syscall_resolve_num = riscv64_syscall_resolve_num,
+	.syscall_rewrite = NULL,
+	.rule_add = NULL,
+};
diff -Naur libseccomp-2.3.2-old/src/arch-riscv64.h libseccomp-2.3.2/src/arch-riscv64.h
--- libseccomp-2.3.2-old/src/arch-riscv64.h	1970-01-01 08:00:00.000000000 +0800
+++ libseccomp-2.3.2/src/arch-riscv64.h	2018-02-20 19:06:00.845924233 +0800
@@ -0,0 +1,36 @@
+/**
+ * Enhanced Seccomp AArch64 Syscall Table
+ *
+ * Copyright (c) 2018 Icenowy Zheng <icenowy@aosc.io>
+ */
+
+/*
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of version 2.1 of the GNU Lesser General Public License as
+ * published by the Free Software Foundation.
+ *
+ * This library is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License
+ * for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, see <http://www.gnu.org/licenses>.
+ */
+
+#ifndef _ARCH_RISCV64_H
+#define _ARCH_RISCV64_H
+
+#include <inttypes.h>
+
+#include "arch.h"
+#include "system.h"
+
+extern const struct arch_def arch_def_riscv64;
+
+int riscv64_syscall_resolve_name(const char *name);
+const char *riscv64_syscall_resolve_num(int num);
+
+const struct arch_syscall_def *riscv64_syscall_iterate(unsigned int spot);
+
+#endif
diff -Naur libseccomp-2.3.2-old/src/arch-riscv64-syscalls.c libseccomp-2.3.2/src/arch-riscv64-syscalls.c
--- libseccomp-2.3.2-old/src/arch-riscv64-syscalls.c	1970-01-01 08:00:00.000000000 +0800
+++ libseccomp-2.3.2/src/arch-riscv64-syscalls.c	2018-02-20 19:06:00.845924233 +0800
@@ -0,0 +1,524 @@
+/**
+ * Enhanced Seccomp AArch64 Syscall Table
+ *
+ * Copyright (c) 2018 Icenowy Zheng <icenowy@aosc.io>
+ * 
+ * Based on arch-aarch64-syscalls.c, which is:
+ *   Copyright (c) 2014 Red Hat
+ */
+
+/*
+ * This library is free software; you can redistribute it and/or modify it
+ * under the terms of version 2.1 of the GNU Lesser General Public License as
+ * published by the Free Software Foundation.
+ *
+ * This library is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License
+ * for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with this library; if not, see <http://www.gnu.org/licenses>.
+ */
+
+#include <string.h>
+
+#include <seccomp.h>
+
+#include "arch.h"
+#include "arch-riscv64.h"
+
+/* NOTE: based on Linux 4.15 */
+const struct arch_syscall_def riscv64_syscall_table[] = { \
+	{ "_llseek", __PNR__llseek },
+	{ "_newselect", __PNR__newselect },
+	{ "_sysctl", __PNR__sysctl },
+	{ "accept", 202 },
+	{ "accept4", 242 },
+	{ "access", __PNR_access },
+	{ "acct", 89 },
+	{ "add_key", 217 },
+	{ "adjtimex", 171 },
+	{ "afs_syscall", __PNR_afs_syscall },
+	{ "alarm", __PNR_alarm },
+	{ "arm_fadvise64_64", __PNR_arm_fadvise64_64 },
+	{ "arm_sync_file_range", __PNR_arm_sync_file_range },
+	{ "arch_prctl", __PNR_arch_prctl },
+	{ "bdflush", __PNR_bdflush },
+	{ "bind", 200 },
+	{ "bpf", 280 },
+	{ "break", __PNR_break },
+	{ "breakpoint", __PNR_breakpoint },
+	{ "brk", 214 },
+	{ "cachectl", __PNR_cachectl },
+	{ "cacheflush", __PNR_cacheflush },
+	{ "capget", 90 },
+	{ "capset", 91 },
+	{ "chdir", 49 },
+	{ "chmod", __PNR_chmod },
+	{ "chown", __PNR_chown },
+	{ "chown32", __PNR_chown32 },
+	{ "chroot", 51 },
+	{ "clock_adjtime", 266 },
+	{ "clock_getres", 114 },
+	{ "clock_gettime", 113 },
+	{ "clock_nanosleep", 115 },
+	{ "clock_settime", 112 },
+	{ "clone", 220 },
+	{ "close", 57 },
+	{ "connect", 203 },
+	{ "copy_file_range", 285 },
+	{ "creat", __PNR_creat },
+	{ "create_module", __PNR_create_module },
+	{ "delete_module", 106 },
+	{ "dup", 23 },
+	{ "dup2", __PNR_dup2 },
+	{ "dup3", 24 },
+	{ "epoll_create", __PNR_epoll_create },
+	{ "epoll_create1", 20 },
+	{ "epoll_ctl", 21 },
+	{ "epoll_ctl_old", __PNR_epoll_ctl_old },
+	{ "epoll_pwait", 22 },
+	{ "epoll_wait", __PNR_epoll_wait },
+	{ "epoll_wait_old", __PNR_epoll_wait_old },
+	{ "eventfd", __PNR_eventfd },
+	{ "eventfd2", 19 },
+	{ "execve", 221 },
+	{ "execveat", 281 },
+	{ "exit", 93 },
+	{ "exit_group", 94 },
+	{ "faccessat", 48 },
+	{ "fadvise64", 223 },
+	{ "fadvise64_64", __PNR_fadvise64_64 },
+	{ "fallocate", 47 },
+	{ "fanotify_init", 262 },
+	{ "fanotify_mark", 263 },
+	{ "fchdir", 50 },
+	{ "fchmod", 52 },
+	{ "fchmodat", 53 },
+	{ "fchown", 55 },
+	{ "fchown32", __PNR_fchown32 },
+	{ "fchownat", 54 },
+	{ "fcntl", 25 },
+	{ "fcntl64", __PNR_fcntl64 },
+	{ "fdatasync", 83 },
+	{ "fgetxattr", 10 },
+	{ "finit_module", 273 },
+	{ "flistxattr", 13 },
+	{ "flock", 32 },
+	{ "fork", __PNR_fork },
+	{ "fremovexattr", 16 },
+	{ "fsetxattr", 7 },
+	{ "fstat", 80 },
+	{ "fstat64", __PNR_fstat64 },
+	{ "fstatat64", __PNR_fstatat64 },
+	{ "fstatfs", 44 },
+	{ "fstatfs64", __PNR_fstatfs64 },
+	{ "fsync", 82 },
+	{ "ftime", __PNR_ftime },
+	{ "ftruncate", 46 },
+	{ "ftruncate64", __PNR_ftruncate64 },
+	{ "futex", 98 },
+	{ "futimesat", __PNR_futimesat },
+	{ "get_kernel_syms", __PNR_get_kernel_syms },
+	{ "get_mempolicy", 236 },
+	{ "get_robust_list", 100 },
+	{ "get_thread_area", __PNR_get_thread_area },
+	{ "getcpu", 168 },
+	{ "getcwd", 17 },
+	{ "getdents", __PNR_getdents },
+	{ "getdents64", 61 },
+	{ "getegid", 177 },
+	{ "getegid32", __PNR_getegid32 },
+	{ "geteuid", 175 },
+	{ "geteuid32", __PNR_geteuid32 },
+	{ "getgid", 176 },
+	{ "getgid32", __PNR_getgid32 },
+	{ "getgroups", 158 },
+	{ "getgroups32", __PNR_getgroups32 },
+	{ "getitimer", 102 },
+	{ "getpeername", 205 },
+	{ "getpgid", 155 },
+	{ "getpgrp", __PNR_getpgrp },
+	{ "getpid", 172 },
+	{ "getpmsg", __PNR_getpmsg },
+	{ "getppid", 173 },
+	{ "getpriority", 141 },
+	{ "getrandom", 278 },
+	{ "getresgid", 150 },
+	{ "getresgid32", __PNR_getresgid32 },
+	{ "getresuid", 148 },
+	{ "getresuid32", __PNR_getresuid32 },
+	{ "getrlimit", 163 },
+	{ "getrusage", 165 },
+	{ "getsid", 156 },
+	{ "getsockname", 204 },
+	{ "getsockopt", 209 },
+	{ "gettid", 178 },
+	{ "gettimeofday", 169 },
+	{ "getuid", 174 },
+	{ "getuid32", __PNR_getuid32 },
+	{ "getxattr", 8 },
+	{ "gtty", __PNR_gtty },
+	{ "idle", __PNR_idle },
+	{ "init_module", 105 },
+	{ "inotify_add_watch", 27 },
+	{ "inotify_init", __PNR_inotify_init },
+	{ "inotify_init1", 26 },
+	{ "inotify_rm_watch", 28 },
+	{ "io_cancel", 3 },
+	{ "io_destroy", 1 },
+	{ "io_getevents", 4 },
+	{ "io_setup", 0 },
+	{ "io_submit", 2 },
+	{ "ioctl", 29 },
+	{ "ioperm", __PNR_ioperm },
+	{ "iopl", __PNR_iopl },
+	{ "ioprio_get", 31 },
+	{ "ioprio_set", 30 },
+	{ "ipc", __PNR_ipc },
+	{ "kcmp", 272 },
+	{ "kexec_file_load", __PNR_kexec_file_load },
+	{ "kexec_load", 104 },
+	{ "keyctl", 219 },
+	{ "kill", 129 },
+	{ "lchown", __PNR_lchown },
+	{ "lchown32", __PNR_lchown32 },
+	{ "lgetxattr", 9 },
+	{ "link", __PNR_link },
+	{ "linkat", 37 },
+	{ "listen", 201 },
+	{ "listxattr", 11 },
+	{ "llistxattr", 12 },
+	{ "lock", __PNR_lock },
+	{ "lookup_dcookie", 18 },
+	{ "lremovexattr", 15 },
+	{ "lseek", 62 },
+	{ "lsetxattr", 6 },
+	{ "lstat", __PNR_lstat },
+	{ "lstat64", __PNR_lstat64 },
+	{ "madvise", 233 },
+	{ "mbind", 235 },
+	{ "membarrier", 283 },
+	{ "memfd_create", 279 },
+	{ "migrate_pages", 238 },
+	{ "mincore", 232 },
+	{ "mkdir", __PNR_mkdir },
+	{ "mkdirat", 34 },
+	{ "mknod", __PNR_mknod },
+	{ "mknodat", 33 },
+	{ "mlock", 228 },
+	{ "mlock2", 284 },
+	{ "mlockall", 230 },
+	{ "mmap", 222 },
+	{ "mmap2", __PNR_mmap2 },
+	{ "modify_ldt", __PNR_modify_ldt },
+	{ "mount", 40 },
+	{ "move_pages", 239 },
+	{ "mprotect", 226 },
+	{ "mpx", __PNR_mpx },
+	{ "mq_getsetattr", 185 },
+	{ "mq_notify", 184 },
+	{ "mq_open", 180 },
+	{ "mq_timedreceive", 183 },
+	{ "mq_timedsend", 182 },
+	{ "mq_unlink", 181 },
+	{ "mremap", 216 },
+	{ "msgctl", 187 },
+	{ "msgget", 186 },
+	{ "msgrcv", 188 },
+	{ "msgsnd", 189 },
+	{ "msync", 227 },
+	{ "multiplexer", __PNR_multiplexer },
+	{ "munlock", 229 },
+	{ "munlockall", 231 },
+	{ "munmap", 215 },
+	{ "name_to_handle_at", 264 },
+	{ "nanosleep", 101 },
+	{ "newfstatat", 79 },
+	{ "nfsservctl", 42 },
+	{ "nice", __PNR_nice },
+	{ "oldfstat", __PNR_oldfstat },
+	{ "oldlstat", __PNR_oldlstat },
+	{ "oldolduname", __PNR_oldolduname },
+	{ "oldstat", __PNR_oldstat },
+	{ "olduname", __PNR_olduname },
+	{ "oldwait4", __PNR_oldwait4 },
+	{ "open", __PNR_open },
+	{ "open_by_handle_at", 265 },
+	{ "openat", 56 },
+	{ "pause", __PNR_pause },
+	{ "pciconfig_iobase", __PNR_pciconfig_iobase },
+	{ "pciconfig_read", __PNR_pciconfig_read },
+	{ "pciconfig_write", __PNR_pciconfig_write },
+	{ "perf_event_open", 241 },
+	{ "personality", 92 },
+	{ "pipe", __PNR_pipe },
+	{ "pipe2", 59 },
+	{ "pivot_root", 41 },
+	{ "pkey_alloc", 289 },
+	{ "pkey_free", 290 },
+	{ "pkey_mprotect", 288 },
+	{ "poll", __PNR_poll },
+	{ "ppoll", 73 },
+	{ "prctl", 167 },
+	{ "pread64", 67 },
+	{ "preadv", 69 },
+	{ "preadv2", 286 },
+	{ "prlimit64", 261 },
+	{ "process_vm_readv", 270 },
+	{ "process_vm_writev", 271 },
+	{ "prof", __PNR_prof },
+	{ "profil", __PNR_profil },
+	{ "pselect6", 72 },
+	{ "ptrace", 117 },
+	{ "putpmsg", __PNR_putpmsg },
+	{ "pwrite64", 68 },
+	{ "pwritev", 70 },
+	{ "pwritev2", 287 },
+	{ "query_module", __PNR_query_module },
+	{ "quotactl", 60 },
+	{ "read", 63 },
+	{ "readahead", 213 },
+	{ "readdir", __PNR_readdir },
+	{ "readlink", __PNR_readlink },
+	{ "readlinkat", 78 },
+	{ "readv", 65 },
+	{ "reboot", 142 },
+	{ "recv", __PNR_recv },
+	{ "recvfrom", 207 },
+	{ "recvmmsg", 243 },
+	{ "recvmsg", 212 },
+	{ "remap_file_pages", 234 },
+	{ "removexattr", 14 },
+	{ "rename", __PNR_rename },
+	{ "renameat", __PNR_renameat },
+	{ "renameat2", 276 },
+	{ "request_key", 218 },
+	{ "restart_syscall", 128 },
+	{ "riscv_flush_icache", 259 },
+	{ "rmdir", __PNR_rmdir },
+	{ "rt_sigaction", 134 },
+	{ "rt_sigpending", 136 },
+	{ "rt_sigprocmask", 135 },
+	{ "rt_sigqueueinfo", 138 },
+	{ "rt_sigreturn", 139 },
+	{ "rt_sigsuspend", 133 },
+	{ "rt_sigtimedwait", 137 },
+	{ "rt_tgsigqueueinfo", 240 },
+	{ "rtas", __PNR_rtas },
+	{ "s390_pci_mmio_read", __PNR_s390_pci_mmio_read },
+	{ "s390_pci_mmio_write", __PNR_s390_pci_mmio_write },
+	{ "s390_runtime_instr", __PNR_s390_runtime_instr },
+	{ "sched_get_priority_max", 125 },
+	{ "sched_get_priority_min", 126 },
+	{ "sched_getaffinity", 123 },
+	{ "sched_getattr", 275 },
+	{ "sched_getparam", 121 },
+	{ "sched_getscheduler", 120 },
+	{ "sched_rr_get_interval", 127 },
+	{ "sched_setaffinity", 122 },
+	{ "sched_setattr", 274 },
+	{ "sched_setparam", 118 },
+	{ "sched_setscheduler", 119 },
+	{ "sched_yield", 124 },
+	{ "seccomp", 277 },
+	{ "security", __PNR_security },
+	{ "select", __PNR_select },
+	{ "semctl", 191 },
+	{ "semget", 190 },
+	{ "semop", 193 },
+	{ "semtimedop", 192 },
+	{ "send", __PNR_send },
+	{ "sendfile", 71 },
+	{ "sendfile64", __PNR_sendfile64 },
+	{ "sendmmsg", 269 },
+	{ "sendmsg", 211 },
+	{ "sendto", 206 },
+	{ "set_mempolicy", 237 },
+	{ "set_robust_list", 99 },
+	{ "set_thread_area", __PNR_set_thread_area },
+	{ "set_tid_address", 96 },
+	{ "set_tls", __PNR_set_tls },
+	{ "setdomainname", 162 },
+	{ "setfsgid", 152 },
+	{ "setfsgid32", __PNR_setfsgid32 },
+	{ "setfsuid", 151 },
+	{ "setfsuid32", __PNR_setfsuid32 },
+	{ "setgid", 144 },
+	{ "setgid32", __PNR_setgid32 },
+	{ "setgroups", 159 },
+	{ "setgroups32", __PNR_setgroups32 },
+	{ "sethostname", 161 },
+	{ "setitimer", 103 },
+	{ "setns", 268 },
+	{ "setpgid", 154 },
+	{ "setpriority", 140 },
+	{ "setregid", 143 },
+	{ "setregid32", __PNR_setregid32 },
+	{ "setresgid", 149 },
+	{ "setresgid32", __PNR_setresgid32 },
+	{ "setresuid", 147 },
+	{ "setresuid32", __PNR_setresuid32 },
+	{ "setreuid", 145 },
+	{ "setreuid32", __PNR_setreuid32 },
+	{ "setrlimit", 164 },
+	{ "setsid", 157 },
+	{ "setsockopt", 208 },
+	{ "settimeofday", 170 },
+	{ "setuid", 146 },
+	{ "setuid32", __PNR_setuid32 },
+	{ "setxattr", 5 },
+	{ "sgetmask", __PNR_sgetmask },
+	{ "shmat", 196 },
+	{ "shmctl", 195 },
+	{ "shmdt", 197 },
+	{ "shmget", 194 },
+	{ "shutdown", 210 },
+	{ "sigaction", __PNR_sigaction },
+	{ "sigaltstack", 132 },
+	{ "signal", __PNR_signal },
+	{ "signalfd", __PNR_signalfd },
+	{ "signalfd4", 74 },
+	{ "sigpending", __PNR_sigpending },
+	{ "sigprocmask", __PNR_sigprocmask },
+	{ "sigreturn", __PNR_sigreturn },
+	{ "sigsuspend", __PNR_sigsuspend },
+	{ "socket", 198 },
+	{ "socketcall", __PNR_socketcall },
+	{ "socketpair", 199 },
+	{ "splice", 76 },
+	{ "spu_create", __PNR_spu_create },
+	{ "spu_run", __PNR_spu_run },
+	{ "ssetmask", __PNR_ssetmask },
+	{ "stat", __PNR_stat },
+	{ "stat64", __PNR_stat64 },
+	{ "statfs", 43 },
+	{ "statfs64", __PNR_statfs64 },
+	{ "stime", __PNR_stime },
+	{ "stty", __PNR_stty },
+	{ "subpage_prot", __PNR_subpage_prot },
+	{ "swapcontext", __PNR_swapcontext },
+	{ "swapoff", 225 },
+	{ "swapon", 224 },
+	{ "switch_endian", __PNR_switch_endian },
+	{ "symlink", __PNR_symlink },
+	{ "symlinkat", 36 },
+	{ "sync", 81 },
+	{ "sync_file_range", 84 },
+	{ "sync_file_range2", __PNR_sync_file_range2 },
+	{ "syncfs", 267 },
+	{ "syscall", __PNR_syscall },
+	{ "sys_debug_setcontext", __PNR_sys_debug_setcontext },
+	{ "sysfs", __PNR_sysfs },
+	{ "sysinfo", 179 },
+	{ "syslog", 116 },
+	{ "sysmips", __PNR_sysmips },
+	{ "tee", 77 },
+	{ "tgkill", 131 },
+	{ "time", __PNR_time },
+	{ "timer_create", 107 },
+	{ "timer_delete", 111 },
+	{ "timer_getoverrun", 109 },
+	{ "timer_gettime", 108 },
+	{ "timer_settime", 110 },
+	{ "timerfd", __PNR_timerfd },
+	{ "timerfd_create", 85 },
+	{ "timerfd_gettime", 87 },
+	{ "timerfd_settime", 86 },
+	{ "times", 153 },
+	{ "tkill", 130 },
+	{ "truncate", 45 },
+	{ "truncate64", __PNR_truncate64 },
+	{ "tuxcall", __PNR_tuxcall },
+	{ "ugetrlimit", __PNR_ugetrlimit },
+	{ "ulimit", __PNR_ulimit },
+	{ "umask", 166 },
+	{ "umount", __PNR_umount },
+	{ "umount2", 39 },
+	{ "uname", 160 },
+	{ "unlink", __PNR_unlink },
+	{ "unlinkat", 35 },
+	{ "unshare", 97 },
+	{ "uselib", __PNR_uselib },
+	{ "userfaultfd", 282 },
+	{ "usr26", __PNR_usr26 },
+	{ "usr32", __PNR_usr32 },
+	{ "ustat", __PNR_ustat },
+	{ "utime", __PNR_utime },
+	{ "utimensat", 88 },
+	{ "utimes", __PNR_utimes },
+	{ "vfork", __PNR_vfork },
+	{ "vhangup", 58 },
+	{ "vm86", __PNR_vm86 },
+	{ "vm86old", __PNR_vm86old },
+	{ "vmsplice", 75 },
+	{ "vserver", __PNR_vserver },
+	{ "wait4", 260 },
+	{ "waitid", 95 },
+	{ "waitpid", __PNR_waitpid },
+	{ "write", 64 },
+	{ "writev", 66 },
+	{ NULL, __NR_SCMP_ERROR },
+};
+
+/**
+ * Resolve a syscall name to a number
+ * @param name the syscall name
+ *
+ * Resolve the given syscall name to the syscall number using the syscall table.
+ * Returns the syscall number on success, including negative pseudo syscall
+ * numbers; returns __NR_SCMP_ERROR on failure.
+ *
+ */
+int riscv64_syscall_resolve_name(const char *name)
+{
+	unsigned int iter;
+	const struct arch_syscall_def *table = riscv64_syscall_table;
+
+	/* XXX - plenty of room for future improvement here */
+	for (iter = 0; table[iter].name != NULL; iter++) {
+		if (strcmp(name, table[iter].name) == 0)
+			return table[iter].num;
+	}
+
+	return __NR_SCMP_ERROR;
+}
+
+/**
+ * Resolve a syscall number to a name
+ * @param num the syscall number
+ *
+ * Resolve the given syscall number to the syscall name using the syscall table.
+ * Returns a pointer to the syscall name string on success, including pseudo
+ * syscall names; returns NULL on failure.
+ *
+ */
+const char *riscv64_syscall_resolve_num(int num)
+{
+	unsigned int iter;
+	const struct arch_syscall_def *table = riscv64_syscall_table;
+
+	/* XXX - plenty of room for future improvement here */
+	for (iter = 0; table[iter].num != __NR_SCMP_ERROR; iter++) {
+		if (num == table[iter].num)
+			return table[iter].name;
+	}
+
+	return NULL;
+}
+
+
+/**
+ * Iterate through the syscall table and return the syscall mapping
+ * @param spot the offset into the syscall table
+ *
+ * Return the syscall mapping at position @spot or NULL on failure.  This
+ * function should only ever be used internally by libseccomp.
+ *
+ */
+const struct arch_syscall_def *riscv64_syscall_iterate(unsigned int spot)
+{
+	/* XXX - no safety checks here */
+	return &riscv64_syscall_table[spot];
+}
diff -Naur libseccomp-2.3.2-old/src/arch-s390-syscalls.c libseccomp-2.3.2/src/arch-s390-syscalls.c
--- libseccomp-2.3.2-old/src/arch-s390-syscalls.c	2017-02-24 06:31:31.663112269 +0800
+++ libseccomp-2.3.2/src/arch-s390-syscalls.c	2018-02-20 19:06:00.849257606 +0800
@@ -278,6 +278,7 @@
 	{ "renameat2", 347 },
 	{ "request_key", 279 },
 	{ "restart_syscall", 7 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 40 },
 	{ "rt_sigaction", 174 },
 	{ "rt_sigpending", 176 },
diff -Naur libseccomp-2.3.2-old/src/arch-s390x-syscalls.c libseccomp-2.3.2/src/arch-s390x-syscalls.c
--- libseccomp-2.3.2-old/src/arch-s390x-syscalls.c	2017-02-24 06:31:31.679778966 +0800
+++ libseccomp-2.3.2/src/arch-s390x-syscalls.c	2018-02-20 19:06:00.842590860 +0800
@@ -278,6 +278,7 @@
 	{ "renameat2", 347 },
 	{ "request_key", 279 },
 	{ "restart_syscall", 7 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 40 },
 	{ "rt_sigaction", 174 },
 	{ "rt_sigpending", 176 },
diff -Naur libseccomp-2.3.2-old/src/arch-syscall-check.c libseccomp-2.3.2/src/arch-syscall-check.c
--- libseccomp-2.3.2-old/src/arch-syscall-check.c	2017-02-28 06:24:22.638360424 +0800
+++ libseccomp-2.3.2/src/arch-syscall-check.c	2018-02-20 19:06:00.845924233 +0800
@@ -35,6 +35,7 @@
 #include "arch-mips64n32.h"
 #include "arch-ppc.h"
 #include "arch-ppc64.h"
+#include "arch-riscv64.h"
 #include "arch-s390.h"
 #include "arch-s390x.h"
 
@@ -73,6 +74,7 @@
 	int i_mips64n32 = 0;
 	int i_ppc = 0;
 	int i_ppc64 = 0;
+	int i_riscv64 = 0;
 	int i_s390 = 0;
 	int i_s390x = 0;
 	char str_miss[256];
@@ -107,6 +109,8 @@
 			      ppc_syscall_iterate(i_ppc));
 		syscall_check(str_miss, sys_name, "ppc64",
 			      ppc64_syscall_iterate(i_ppc64));
+		syscall_check(str_miss, sys_name, "riscv64",
+			      riscv64_syscall_iterate(i_riscv64));
 		syscall_check(str_miss, sys_name, "s390",
 			      s390_syscall_iterate(i_s390));
 		syscall_check(str_miss, sys_name, "s390x",
@@ -141,6 +145,8 @@
 			i_ppc = -1;
 		if (!ppc64_syscall_iterate(++i_ppc64)->name)
 			i_ppc64 = -1;
+		if (!riscv64_syscall_iterate(++i_riscv64)->name)
+			i_riscv64 = -1;
 		if (!s390_syscall_iterate(++i_s390)->name)
 			i_s390 = -1;
 		if (!s390x_syscall_iterate(++i_s390x)->name)
@@ -149,6 +155,7 @@
 		 i_arm >= 0 && i_aarch64 >= 0 &&
 		 i_mips >= 0 && i_mips64 >= 0 && i_mips64n32 >= 0 &&
 		 i_ppc >= 0 && i_ppc64 >= 0 &&
+		 i_riscv64 >= 0 &&
 		 i_s390 >= 0 && i_s390x >= 0);
 
 	/* check for any leftovers */
@@ -193,6 +200,10 @@
 		printf("ERROR, ppc64 has additional syscalls\n");
 		return 1;
 	}
+	if (i_riscv64 >= 0) {
+		printf("ERROR, riscv64 has additional syscalls\n");
+		return 1;
+	}
 	if (i_s390 >= 0) {
 		printf("ERROR, s390 has additional syscalls\n");
 		return 1;
diff -Naur libseccomp-2.3.2-old/src/arch-syscall-validate libseccomp-2.3.2/src/arch-syscall-validate
--- libseccomp-2.3.2-old/src/arch-syscall-validate	2017-02-03 08:27:28.317420376 +0800
+++ libseccomp-2.3.2/src/arch-syscall-validate	2018-02-20 19:06:00.845924233 +0800
@@ -377,6 +377,47 @@
 }
 
 #
+# Dump the aarch64 system syscall table
+#
+# Arguments:
+#     1    path to the kernel source
+#
+#  Dump the architecture's syscall table to stdout.
+#
+function dump_sys_riscv64() {
+	gcc -E -dM -I$1/include/uapi \
+		-D__BITS_PER_LONG=64 \
+		$1/include/uapi/asm-generic/unistd.h | \
+		grep "^#define __NR_" | \
+		sed -e '/__NR_syscalls/d' | \
+		sed -e '/__NR_arch_specific_syscall/d' | \
+		sed -e 's/#define[ \t]\+__NR_\([^ \t]\+\)[ \t]\+\(.*\)/\1\t\2/' | \
+		sed -e 's/__NR3264_statfs/43/' | \
+		sed -e 's/__NR3264_ftruncate/46/' | \
+		sed -e 's/__NR3264_truncate/45/' | \
+		sed -e 's/__NR3264_lseek/62/' | \
+		sed -e 's/__NR3264_sendfile/71/' | \
+		sed -e 's/__NR3264_fstatat/79/' | \
+		sed -e 's/__NR3264_fstatfs/44/' | \
+		sed -e 's/__NR3264_fcntl/25/' | \
+		sed -e 's/__NR3264_fadvise64/223/' | \
+		sed -e 's/__NR3264_mmap/222/' | \
+		sed -e 's/__NR3264_fstat/80/' | \
+		sed -e 's/__NR3264_lstat/1039/' | \
+		sed -e 's/__NR3264_stat/1038/' | \
+		sort
+}
+
+#
+# Dump the riscv64 library syscall table
+#
+#  Dump the library's syscall table to stdout.
+#
+function dump_lib_riscv64() {
+	dump_lib_arch riscv64
+}
+
+#
 # Dump the s390 system syscall table
 #
 # Arguments:
@@ -477,6 +518,9 @@
 	ppc64)
 		dump_sys_ppc64 "$2"
 		;;
+	riscv64)
+		dump_sys_riscv64 "$2"
+		;;
 	s390)
 		dump_sys_s390 "$2"
 		;;
@@ -532,6 +576,9 @@
 	ppc64)
 		dump_lib_ppc64 "$2"
 		;;
+	riscv64)
+		dump_lib_riscv64 "$2"
+		;;
 	s390)
 		dump_lib_s390 "$2"
 		;;
diff -Naur libseccomp-2.3.2-old/src/arch-x32-syscalls.c libseccomp-2.3.2/src/arch-x32-syscalls.c
--- libseccomp-2.3.2-old/src/arch-x32-syscalls.c	2017-02-24 06:31:31.713112362 +0800
+++ libseccomp-2.3.2/src/arch-x32-syscalls.c	2018-02-20 19:06:00.842590860 +0800
@@ -294,6 +294,7 @@
 	{ "renameat2", (X32_SYSCALL_BIT + 316) },
 	{ "request_key", (X32_SYSCALL_BIT + 249) },
 	{ "restart_syscall", (X32_SYSCALL_BIT + 219) },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", (X32_SYSCALL_BIT + 84) },
 	{ "rt_sigaction", (X32_SYSCALL_BIT + 512) },
 	{ "rt_sigpending", (X32_SYSCALL_BIT + 522) },
diff -Naur libseccomp-2.3.2-old/src/arch-x86_64-syscalls.c libseccomp-2.3.2/src/arch-x86_64-syscalls.c
--- libseccomp-2.3.2-old/src/arch-x86_64-syscalls.c	2017-02-24 06:31:31.726445720 +0800
+++ libseccomp-2.3.2/src/arch-x86_64-syscalls.c	2018-02-20 19:06:00.839257487 +0800
@@ -294,6 +294,7 @@
 	{ "renameat2", 316 },
 	{ "request_key", 249 },
 	{ "restart_syscall", 219 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 84 },
 	{ "rt_sigaction", 13 },
 	{ "rt_sigpending", 127 },
diff -Naur libseccomp-2.3.2-old/src/arch-x86-syscalls.c libseccomp-2.3.2/src/arch-x86-syscalls.c
--- libseccomp-2.3.2-old/src/arch-x86-syscalls.c	2017-02-24 06:31:31.743112418 +0800
+++ libseccomp-2.3.2/src/arch-x86-syscalls.c	2018-02-20 19:06:00.839257487 +0800
@@ -294,6 +294,7 @@
 	{ "renameat2", 353 },
 	{ "request_key", 287 },
 	{ "restart_syscall", 0 },
+	{ "riscv_flush_icache", __PNR_riscv_flush_icache },
 	{ "rmdir", 40 },
 	{ "rt_sigaction", 174 },
 	{ "rt_sigpending", 176 },
diff -Naur libseccomp-2.3.2-old/src/Makefile.am libseccomp-2.3.2/src/Makefile.am
--- libseccomp-2.3.2-old/src/Makefile.am	2017-02-28 06:24:22.635027077 +0800
+++ libseccomp-2.3.2/src/Makefile.am	2018-02-20 19:06:00.842590860 +0800
@@ -37,6 +37,7 @@
 	arch-mips64n32.h arch-mips64n32.c arch-mips64n32-syscalls.c \
 	arch-ppc.h arch-ppc.c arch-ppc-syscalls.c \
 	arch-ppc64.h arch-ppc64.c arch-ppc64-syscalls.c \
+	arch-riscv64.h arch-riscv64.c arch-riscv64-syscalls.c \
 	arch-s390.h arch-s390.c arch-s390-syscalls.c \
 	arch-s390x.h arch-s390x.c arch-s390x-syscalls.c
 
diff -Naur libseccomp-2.3.2-old/src/tmp libseccomp-2.3.2/src/tmp
--- libseccomp-2.3.2-old/src/tmp	1970-01-01 08:00:00.000000000 +0800
+++ libseccomp-2.3.2/src/tmp	2018-02-20 19:06:00.845924233 +0800
@@ -0,0 +1,429 @@
+	{ "io_destroy", 1 },
+	{ "io_submit", 2 },
+	{ "io_cancel", 3 },
+	{ "io_getevents", 4 },
+	{ "setxattr", 5 },
+	{ "lsetxattr", 6 },
+	{ "fsetxattr", 7 },
+	{ "getxattr", 8 },
+	{ "lgetxattr", 9 },
+	{ "fgetxattr", 10 },
+	{ "listxattr", 11 },
+	{ "llistxattr", 12 },
+	{ "flistxattr", 13 },
+	{ "removexattr", 14 },
+	{ "lremovexattr", 15 },
+	{ "fremovexattr", 16 },
+	{ "getcwd", 17 },
+	{ "lookup_dcookie", 18 },
+	{ "eventfd2", 19 },
+	{ "epoll_create1", 20 },
+	{ "epoll_ctl", 21 },
+	{ "epoll_pwait", 22 },
+	{ "dup", 23 },
+	{ "dup3", 24 },
+	{ "fcntl", 25 },
+	{ "inotify_init1", 26 },
+	{ "inotify_add_watch", 27 },
+	{ "inotify_rm_watch", 28 },
+	{ "ioctl", 29 },
+	{ "ioprio_set", 30 },
+	{ "ioprio_get", 31 },
+	{ "flock", 32 },
+	{ "mknodat", 33 },
+	{ "mkdirat", 34 },
+	{ "unlinkat", 35 },
+	{ "symlinkat", 36 },
+	{ "linkat", 37 },
+	{ "umount2", 39 },
+	{ "mount", 40 },
+	{ "pivot_root", 41 },
+	{ "nfsservctl", 42 },
+	{ "statfs", 43 },
+	{ "fstatfs", 44 },
+	{ "truncate", 45 },
+	{ "ftruncate", 46 },
+	{ "fallocate", 47 },
+	{ "faccessat", 48 },
+	{ "chdir", 49 },
+	{ "fchdir", 50 },
+	{ "chroot", 51 },
+	{ "fchmod", 52 },
+	{ "fchmodat", 53 },
+	{ "fchownat", 54 },
+	{ "fchown", 55 },
+	{ "openat", 56 },
+	{ "close", 57 },
+	{ "vhangup", 58 },
+	{ "pipe2", 59 },
+	{ "quotactl", 60 },
+	{ "getdents64", 61 },
+	{ "lseek", 62 },
+	{ "read", 63 },
+	{ "write", 64 },
+	{ "readv", 65 },
+	{ "writev", 66 },
+	{ "pread64", 67 },
+	{ "pwrite64", 68 },
+	{ "preadv", 69 },
+	{ "pwritev", 70 },
+	{ "sendfile", 71 },
+	{ "pselect6", 72 },
+	{ "ppoll", 73 },
+	{ "signalfd4", 74 },
+	{ "vmsplice", 75 },
+	{ "splice", 76 },
+	{ "tee", 77 },
+	{ "readlinkat", 78 },
+	{ "newfstatat", 79 },
+	{ "fstat", 80 },
+	{ "sync", 81 },
+	{ "fsync", 82 },
+	{ "fdatasync", 83 },
+	{ "sync_file_range", 84 },
+	{ "timerfd_create", 85 },
+	{ "timerfd_settime", 86 },
+	{ "timerfd_gettime", 87 },
+	{ "utimensat", 88 },
+	{ "acct", 89 },
+	{ "capget", 90 },
+	{ "capset", 91 },
+	{ "personality", 92 },
+	{ "exit", 93 },
+	{ "exit_group", 94 },
+	{ "waitid", 95 },
+	{ "set_tid_address", 96 },
+	{ "unshare", 97 },
+	{ "futex", 98 },
+	{ "set_robust_list", 99 },
+	{ "get_robust_list", 100 },
+	{ "nanosleep", 101 },
+	{ "getitimer", 102 },
+	{ "setitimer", 103 },
+	{ "kexec_load", 104 },
+	{ "init_module", 105 },
+	{ "delete_module", 106 },
+	{ "timer_create", 107 },
+	{ "timer_gettime", 108 },
+	{ "timer_getoverrun", 109 },
+	{ "timer_settime", 110 },
+	{ "timer_delete", 111 },
+	{ "clock_settime", 112 },
+	{ "clock_gettime", 113 },
+	{ "clock_getres", 114 },
+	{ "clock_nanosleep", 115 },
+	{ "syslog", 116 },
+	{ "ptrace", 117 },
+	{ "sched_setparam", 118 },
+	{ "sched_setscheduler", 119 },
+	{ "sched_getscheduler", 120 },
+	{ "sched_getparam", 121 },
+	{ "sched_setaffinity", 122 },
+	{ "sched_getaffinity", 123 },
+	{ "sched_yield", 124 },
+	{ "sched_get_priority_max", 125 },
+	{ "sched_get_priority_min", 126 },
+	{ "sched_rr_get_interval", 127 },
+	{ "restart_syscall", 128 },
+	{ "kill", 129 },
+	{ "tkill", 130 },
+	{ "tgkill", 131 },
+	{ "sigaltstack", 132 },
+	{ "rt_sigsuspend", 133 },
+	{ "rt_sigaction", 134 },
+	{ "rt_sigprocmask", 135 },
+	{ "rt_sigpending", 136 },
+	{ "rt_sigtimedwait", 137 },
+	{ "rt_sigqueueinfo", 138 },
+	{ "rt_sigreturn", 139 },
+	{ "setpriority", 140 },
+	{ "getpriority", 141 },
+	{ "reboot", 142 },
+	{ "setregid", 143 },
+	{ "setgid", 144 },
+	{ "setreuid", 145 },
+	{ "setuid", 146 },
+	{ "setresuid", 147 },
+	{ "getresuid", 148 },
+	{ "setresgid", 149 },
+	{ "getresgid", 150 },
+	{ "setfsuid", 151 },
+	{ "setfsgid", 152 },
+	{ "times", 153 },
+	{ "setpgid", 154 },
+	{ "getpgid", 155 },
+	{ "getsid", 156 },
+	{ "setsid", 157 },
+	{ "getgroups", 158 },
+	{ "setgroups", 159 },
+	{ "uname", 160 },
+	{ "sethostname", 161 },
+	{ "setdomainname", 162 },
+	{ "getrlimit", 163 },
+	{ "setrlimit", 164 },
+	{ "getrusage", 165 },
+	{ "umask", 166 },
+	{ "prctl", 167 },
+	{ "getcpu", 168 },
+	{ "gettimeofday", 169 },
+	{ "settimeofday", 170 },
+	{ "adjtimex", 171 },
+	{ "getpid", 172 },
+	{ "getppid", 173 },
+	{ "getuid", 174 },
+	{ "geteuid", 175 },
+	{ "getgid", 176 },
+	{ "getegid", 177 },
+	{ "gettid", 178 },
+	{ "sysinfo", 179 },
+	{ "mq_open", 180 },
+	{ "mq_unlink", 181 },
+	{ "mq_timedsend", 182 },
+	{ "mq_timedreceive", 183 },
+	{ "mq_notify", 184 },
+	{ "mq_getsetattr", 185 },
+	{ "msgget", 186 },
+	{ "msgctl", 187 },
+	{ "msgrcv", 188 },
+	{ "msgsnd", 189 },
+	{ "semget", 190 },
+	{ "semctl", 191 },
+	{ "semtimedop", 192 },
+	{ "semop", 193 },
+	{ "shmget", 194 },
+	{ "shmctl", 195 },
+	{ "shmat", 196 },
+	{ "shmdt", 197 },
+	{ "socket", 198 },
+	{ "socketpair", 199 },
+	{ "bind", 200 },
+	{ "listen", 201 },
+	{ "accept", 202 },
+	{ "connect", 203 },
+	{ "getsockname", 204 },
+	{ "getpeername", 205 },
+	{ "sendto", 206 },
+	{ "recvfrom", 207 },
+	{ "setsockopt", 208 },
+	{ "getsockopt", 209 },
+	{ "shutdown", 210 },
+	{ "sendmsg", 211 },
+	{ "recvmsg", 212 },
+	{ "readahead", 213 },
+	{ "brk", 214 },
+	{ "munmap", 215 },
+	{ "mremap", 216 },
+	{ "add_key", 217 },
+	{ "request_key", 218 },
+	{ "keyctl", 219 },
+	{ "clone", 220 },
+	{ "execve", 221 },
+	{ "mmap", 222 },
+	{ "fadvise64", 223 },
+	{ "swapon", 224 },
+	{ "swapoff", 225 },
+	{ "mprotect", 226 },
+	{ "msync", 227 },
+	{ "mlock", 228 },
+	{ "munlock", 229 },
+	{ "mlockall", 230 },
+	{ "munlockall", 231 },
+	{ "mincore", 232 },
+	{ "madvise", 233 },
+	{ "remap_file_pages", 234 },
+	{ "mbind", 235 },
+	{ "get_mempolicy", 236 },
+	{ "set_mempolicy", 237 },
+	{ "migrate_pages", 238 },
+	{ "move_pages", 239 },
+	{ "rt_tgsigqueueinfo", 240 },
+	{ "perf_event_open", 241 },
+	{ "accept4", 242 },
+	{ "recvmmsg", 243 },
+	{ "wait4", 260 },
+	{ "prlimit64", 261 },
+	{ "fanotify_init", 262 },
+	{ "fanotify_mark", 263 },
+	{ "name_to_handle_at", 264 },
+	{ "open_by_handle_at", 265 },
+	{ "clock_adjtime", 266 },
+	{ "syncfs", 267 },
+	{ "setns", 268 },
+	{ "sendmmsg", 269 },
+	{ "process_vm_readv", 270 },
+	{ "process_vm_writev", 271 },
+	{ "kcmp", 272 },
+	{ "finit_module", 273 },
+	{ "sched_setattr", 274 },
+	{ "sched_getattr", 275 },
+	{ "renameat2", 276 },
+	{ "seccomp", 277 },
+	{ "getrandom", 278 },
+	{ "memfd_create", 279 },
+	{ "bpf", 280 },
+	{ "execveat", 281 },
+	{ "userfaultfd", 282 },
+	{ "membarrier", 283 },
+	{ "mlock2", 284 },
+	{ "copy_file_range", 285 },
+	{ "preadv2", 286 },
+	{ "pwritev2", 287 },
+	{ "pkey_mprotect", 288 },
+	{ "pkey_alloc", 289 },
+	{ "pkey_free", 290 },
+	{ "riscv_flush_icache", 259 },
+	{ "access", __PNR_access },
+	{ "afs_syscall", __PNR_afs_syscall },
+	{ "alarm", __PNR_alarm },
+	{ "arch_prctl", __PNR_arch_prctl },
+	{ "arm_fadvise64_64", __PNR_arm_fadvise64_64 },
+	{ "arm_sync_file_range", __PNR_arm_sync_file_range },
+	{ "bdflush", __PNR_bdflush },
+	{ "break", __PNR_break },
+	{ "breakpoint", __PNR_breakpoint },
+	{ "cachectl", __PNR_cachectl },
+	{ "cacheflush", __PNR_cacheflush },
+	{ "chmod", __PNR_chmod },
+	{ "chown32", __PNR_chown32 },
+	{ "chown", __PNR_chown },
+	{ "create_module", __PNR_create_module },
+	{ "creat", __PNR_creat },
+	{ "dup2", __PNR_dup2 },
+	{ "epoll_create", __PNR_epoll_create },
+	{ "epoll_ctl_old", __PNR_epoll_ctl_old },
+	{ "epoll_wait_old", __PNR_epoll_wait_old },
+	{ "epoll_wait", __PNR_epoll_wait },
+	{ "eventfd", __PNR_eventfd },
+	{ "fadvise64_64", __PNR_fadvise64_64 },
+	{ "fchown32", __PNR_fchown32 },
+	{ "fcntl64", __PNR_fcntl64 },
+	{ "fork", __PNR_fork },
+	{ "fstat64", __PNR_fstat64 },
+	{ "fstatat64", __PNR_fstatat64 },
+	{ "fstatfs64", __PNR_fstatfs64 },
+	{ "ftime", __PNR_ftime },
+	{ "ftruncate64", __PNR_ftruncate64 },
+	{ "futimesat", __PNR_futimesat },
+	{ "getdents", __PNR_getdents },
+	{ "getegid32", __PNR_getegid32 },
+	{ "geteuid32", __PNR_geteuid32 },
+	{ "getgid32", __PNR_getgid32 },
+	{ "getgroups32", __PNR_getgroups32 },
+	{ "get_kernel_syms", __PNR_get_kernel_syms },
+	{ "getpgrp", __PNR_getpgrp },
+	{ "getpmsg", __PNR_getpmsg },
+	{ "getresgid32", __PNR_getresgid32 },
+	{ "getresuid32", __PNR_getresuid32 },
+	{ "get_thread_area", __PNR_get_thread_area },
+	{ "getuid32", __PNR_getuid32 },
+	{ "gtty", __PNR_gtty },
+	{ "idle", __PNR_idle },
+	{ "inotify_init", __PNR_inotify_init },
+	{ "ioperm", __PNR_ioperm },
+	{ "iopl", __PNR_iopl },
+	{ "io_setup", 0 },
+	{ "ipc", __PNR_ipc },
+	{ "kexec_file_load", __PNR_kexec_file_load },
+	{ "lchown32", __PNR_lchown32 },
+	{ "lchown", __PNR_lchown },
+	{ "link", __PNR_link },
+	{ "_llseek", __PNR__llseek },
+	{ "lock", __PNR_lock },
+	{ "lstat64", __PNR_lstat64 },
+	{ "lstat", __PNR_lstat },
+	{ "mkdir", __PNR_mkdir },
+	{ "mknod", __PNR_mknod },
+	{ "mmap2", __PNR_mmap2 },
+	{ "modify_ldt", __PNR_modify_ldt },
+	{ "mpx", __PNR_mpx },
+	{ "multiplexer", __PNR_multiplexer },
+	{ "_newselect", __PNR__newselect },
+	{ "nice", __PNR_nice },
+	{ "oldfstat", __PNR_oldfstat },
+	{ "oldlstat", __PNR_oldlstat },
+	{ "oldolduname", __PNR_oldolduname },
+	{ "oldstat", __PNR_oldstat },
+	{ "olduname", __PNR_olduname },
+	{ "oldwait4", __PNR_oldwait4 },
+	{ "open", __PNR_open },
+	{ "pause", __PNR_pause },
+	{ "pciconfig_iobase", __PNR_pciconfig_iobase },
+	{ "pciconfig_read", __PNR_pciconfig_read },
+	{ "pciconfig_write", __PNR_pciconfig_write },
+	{ "pipe", __PNR_pipe },
+	{ "poll", __PNR_poll },
+	{ "profil", __PNR_profil },
+	{ "prof", __PNR_prof },
+	{ "putpmsg", __PNR_putpmsg },
+	{ "query_module", __PNR_query_module },
+	{ "readdir", __PNR_readdir },
+	{ "readlink", __PNR_readlink },
+	{ "recv", __PNR_recv },
+	{ "rename", __PNR_rename },
+	{ "renameat", __PNR_renameat },
+	{ "rmdir", __PNR_rmdir },
+	{ "rtas", __PNR_rtas },
+	{ "s390_pci_mmio_read", __PNR_s390_pci_mmio_read },
+	{ "s390_pci_mmio_write", __PNR_s390_pci_mmio_write },
+	{ "s390_runtime_instr", __PNR_s390_runtime_instr },
+	{ "security", __PNR_security },
+	{ "select", __PNR_select },
+	{ "sendfile64", __PNR_sendfile64 },
+	{ "send", __PNR_send },
+	{ "setfsgid32", __PNR_setfsgid32 },
+	{ "setfsuid32", __PNR_setfsuid32 },
+	{ "setgid32", __PNR_setgid32 },
+	{ "setgroups32", __PNR_setgroups32 },
+	{ "setregid32", __PNR_setregid32 },
+	{ "setresgid32", __PNR_setresgid32 },
+	{ "setresuid32", __PNR_setresuid32 },
+	{ "setreuid32", __PNR_setreuid32 },
+	{ "set_thread_area", __PNR_set_thread_area },
+	{ "set_tls", __PNR_set_tls },
+	{ "setuid32", __PNR_setuid32 },
+	{ "sgetmask", __PNR_sgetmask },
+	{ "sigaction", __PNR_sigaction },
+	{ "signalfd", __PNR_signalfd },
+	{ "signal", __PNR_signal },
+	{ "sigpending", __PNR_sigpending },
+	{ "sigprocmask", __PNR_sigprocmask },
+	{ "sigreturn", __PNR_sigreturn },
+	{ "sigsuspend", __PNR_sigsuspend },
+	{ "socketcall", __PNR_socketcall },
+	{ "spu_create", __PNR_spu_create },
+	{ "spu_run", __PNR_spu_run },
+	{ "ssetmask", __PNR_ssetmask },
+	{ "stat64", __PNR_stat64 },
+	{ "statfs64", __PNR_statfs64 },
+	{ "stat", __PNR_stat },
+	{ "stime", __PNR_stime },
+	{ "stty", __PNR_stty },
+	{ "subpage_prot", __PNR_subpage_prot },
+	{ "swapcontext", __PNR_swapcontext },
+	{ "switch_endian", __PNR_switch_endian },
+	{ "symlink", __PNR_symlink },
+	{ "sync_file_range2", __PNR_sync_file_range2 },
+	{ "syscall", __PNR_syscall },
+	{ "_sysctl", __PNR__sysctl },
+	{ "sys_debug_setcontext", __PNR_sys_debug_setcontext },
+	{ "sysfs", __PNR_sysfs },
+	{ "sysmips", __PNR_sysmips },
+	{ "time", __PNR_time },
+	{ "timerfd", __PNR_timerfd },
+	{ "truncate64", __PNR_truncate64 },
+	{ "tuxcall", __PNR_tuxcall },
+	{ "ugetrlimit", __PNR_ugetrlimit },
+	{ "ulimit", __PNR_ulimit },
+	{ "umount", __PNR_umount },
+	{ "unlink", __PNR_unlink },
+	{ "uselib", __PNR_uselib },
+	{ "usr26", __PNR_usr26 },
+	{ "usr32", __PNR_usr32 },
+	{ "ustat", __PNR_ustat },
+	{ "utime", __PNR_utime },
+	{ "utimes", __PNR_utimes },
+	{ "vfork", __PNR_vfork },
+	{ "vm86old", __PNR_vm86old },
+	{ "vm86", __PNR_vm86 },
+	{ "vserver", __PNR_vserver },
+	{ "waitpid", __PNR_waitpid },
diff -Naur libseccomp-2.3.2-old/src/tmp2 libseccomp-2.3.2/src/tmp2
--- libseccomp-2.3.2-old/src/tmp2	1970-01-01 08:00:00.000000000 +0800
+++ libseccomp-2.3.2/src/tmp2	2018-02-20 19:06:00.845924233 +0800
@@ -0,0 +1,429 @@
+	{ "accept", 202 },
+	{ "accept4", 242 },
+	{ "access", __PNR_access },
+	{ "acct", 89 },
+	{ "add_key", 217 },
+	{ "adjtimex", 171 },
+	{ "afs_syscall", __PNR_afs_syscall },
+	{ "alarm", __PNR_alarm },
+	{ "arch_prctl", __PNR_arch_prctl },
+	{ "arm_fadvise64_64", __PNR_arm_fadvise64_64 },
+	{ "arm_sync_file_range", __PNR_arm_sync_file_range },
+	{ "bdflush", __PNR_bdflush },
+	{ "bind", 200 },
+	{ "bpf", 280 },
+	{ "break", __PNR_break },
+	{ "breakpoint", __PNR_breakpoint },
+	{ "brk", 214 },
+	{ "cachectl", __PNR_cachectl },
+	{ "cacheflush", __PNR_cacheflush },
+	{ "capget", 90 },
+	{ "capset", 91 },
+	{ "chdir", 49 },
+	{ "chmod", __PNR_chmod },
+	{ "chown32", __PNR_chown32 },
+	{ "chown", __PNR_chown },
+	{ "chroot", 51 },
+	{ "clock_adjtime", 266 },
+	{ "clock_getres", 114 },
+	{ "clock_gettime", 113 },
+	{ "clock_nanosleep", 115 },
+	{ "clock_settime", 112 },
+	{ "clone", 220 },
+	{ "close", 57 },
+	{ "connect", 203 },
+	{ "copy_file_range", 285 },
+	{ "create_module", __PNR_create_module },
+	{ "creat", __PNR_creat },
+	{ "delete_module", 106 },
+	{ "dup", 23 },
+	{ "dup2", __PNR_dup2 },
+	{ "dup3", 24 },
+	{ "epoll_create1", 20 },
+	{ "epoll_create", __PNR_epoll_create },
+	{ "epoll_ctl", 21 },
+	{ "epoll_ctl_old", __PNR_epoll_ctl_old },
+	{ "epoll_pwait", 22 },
+	{ "epoll_wait_old", __PNR_epoll_wait_old },
+	{ "epoll_wait", __PNR_epoll_wait },
+	{ "eventfd2", 19 },
+	{ "eventfd", __PNR_eventfd },
+	{ "execve", 221 },
+	{ "execveat", 281 },
+	{ "exit", 93 },
+	{ "exit_group", 94 },
+	{ "faccessat", 48 },
+	{ "fadvise64", 223 },
+	{ "fadvise64_64", __PNR_fadvise64_64 },
+	{ "fallocate", 47 },
+	{ "fanotify_init", 262 },
+	{ "fanotify_mark", 263 },
+	{ "fchdir", 50 },
+	{ "fchmod", 52 },
+	{ "fchmodat", 53 },
+	{ "fchown32", __PNR_fchown32 },
+	{ "fchown", 55 },
+	{ "fchownat", 54 },
+	{ "fcntl", 25 },
+	{ "fcntl64", __PNR_fcntl64 },
+	{ "fdatasync", 83 },
+	{ "fgetxattr", 10 },
+	{ "finit_module", 273 },
+	{ "flistxattr", 13 },
+	{ "flock", 32 },
+	{ "fork", __PNR_fork },
+	{ "fremovexattr", 16 },
+	{ "fsetxattr", 7 },
+	{ "fstat64", __PNR_fstat64 },
+	{ "fstat", 80 },
+	{ "fstatat64", __PNR_fstatat64 },
+	{ "fstatfs", 44 },
+	{ "fstatfs64", __PNR_fstatfs64 },
+	{ "fsync", 82 },
+	{ "ftime", __PNR_ftime },
+	{ "ftruncate", 46 },
+	{ "ftruncate64", __PNR_ftruncate64 },
+	{ "futex", 98 },
+	{ "futimesat", __PNR_futimesat },
+	{ "getcpu", 168 },
+	{ "getcwd", 17 },
+	{ "getdents64", 61 },
+	{ "getdents", __PNR_getdents },
+	{ "getegid", 177 },
+	{ "getegid32", __PNR_getegid32 },
+	{ "geteuid", 175 },
+	{ "geteuid32", __PNR_geteuid32 },
+	{ "getgid", 176 },
+	{ "getgid32", __PNR_getgid32 },
+	{ "getgroups", 158 },
+	{ "getgroups32", __PNR_getgroups32 },
+	{ "getitimer", 102 },
+	{ "get_kernel_syms", __PNR_get_kernel_syms },
+	{ "get_mempolicy", 236 },
+	{ "getpeername", 205 },
+	{ "getpgid", 155 },
+	{ "getpgrp", __PNR_getpgrp },
+	{ "getpid", 172 },
+	{ "getpmsg", __PNR_getpmsg },
+	{ "getppid", 173 },
+	{ "getpriority", 141 },
+	{ "getrandom", 278 },
+	{ "getresgid", 150 },
+	{ "getresgid32", __PNR_getresgid32 },
+	{ "getresuid", 148 },
+	{ "getresuid32", __PNR_getresuid32 },
+	{ "getrlimit", 163 },
+	{ "get_robust_list", 100 },
+	{ "getrusage", 165 },
+	{ "getsid", 156 },
+	{ "getsockname", 204 },
+	{ "getsockopt", 209 },
+	{ "get_thread_area", __PNR_get_thread_area },
+	{ "gettid", 178 },
+	{ "gettimeofday", 169 },
+	{ "getuid", 174 },
+	{ "getuid32", __PNR_getuid32 },
+	{ "getxattr", 8 },
+	{ "gtty", __PNR_gtty },
+	{ "idle", __PNR_idle },
+	{ "init_module", 105 },
+	{ "inotify_add_watch", 27 },
+	{ "inotify_init1", 26 },
+	{ "inotify_init", __PNR_inotify_init },
+	{ "inotify_rm_watch", 28 },
+	{ "io_cancel", 3 },
+	{ "ioctl", 29 },
+	{ "io_destroy", 1 },
+	{ "io_getevents", 4 },
+	{ "ioperm", __PNR_ioperm },
+	{ "iopl", __PNR_iopl },
+	{ "ioprio_get", 31 },
+	{ "ioprio_set", 30 },
+	{ "io_setup", 0 },
+	{ "io_submit", 2 },
+	{ "ipc", __PNR_ipc },
+	{ "kcmp", 272 },
+	{ "kexec_file_load", __PNR_kexec_file_load },
+	{ "kexec_load", 104 },
+	{ "keyctl", 219 },
+	{ "kill", 129 },
+	{ "lchown32", __PNR_lchown32 },
+	{ "lchown", __PNR_lchown },
+	{ "lgetxattr", 9 },
+	{ "linkat", 37 },
+	{ "link", __PNR_link },
+	{ "listen", 201 },
+	{ "listxattr", 11 },
+	{ "llistxattr", 12 },
+	{ "_llseek", __PNR__llseek },
+	{ "lock", __PNR_lock },
+	{ "lookup_dcookie", 18 },
+	{ "lremovexattr", 15 },
+	{ "lseek", 62 },
+	{ "lsetxattr", 6 },
+	{ "lstat64", __PNR_lstat64 },
+	{ "lstat", __PNR_lstat },
+	{ "madvise", 233 },
+	{ "mbind", 235 },
+	{ "membarrier", 283 },
+	{ "memfd_create", 279 },
+	{ "migrate_pages", 238 },
+	{ "mincore", 232 },
+	{ "mkdirat", 34 },
+	{ "mkdir", __PNR_mkdir },
+	{ "mknodat", 33 },
+	{ "mknod", __PNR_mknod },
+	{ "mlock", 228 },
+	{ "mlock2", 284 },
+	{ "mlockall", 230 },
+	{ "mmap", 222 },
+	{ "mmap2", __PNR_mmap2 },
+	{ "modify_ldt", __PNR_modify_ldt },
+	{ "mount", 40 },
+	{ "move_pages", 239 },
+	{ "mprotect", 226 },
+	{ "mpx", __PNR_mpx },
+	{ "mq_getsetattr", 185 },
+	{ "mq_notify", 184 },
+	{ "mq_open", 180 },
+	{ "mq_timedreceive", 183 },
+	{ "mq_timedsend", 182 },
+	{ "mq_unlink", 181 },
+	{ "mremap", 216 },
+	{ "msgctl", 187 },
+	{ "msgget", 186 },
+	{ "msgrcv", 188 },
+	{ "msgsnd", 189 },
+	{ "msync", 227 },
+	{ "multiplexer", __PNR_multiplexer },
+	{ "munlock", 229 },
+	{ "munlockall", 231 },
+	{ "munmap", 215 },
+	{ "name_to_handle_at", 264 },
+	{ "nanosleep", 101 },
+	{ "newfstatat", 79 },
+	{ "_newselect", __PNR__newselect },
+	{ "nfsservctl", 42 },
+	{ "nice", __PNR_nice },
+	{ "oldfstat", __PNR_oldfstat },
+	{ "oldlstat", __PNR_oldlstat },
+	{ "oldolduname", __PNR_oldolduname },
+	{ "oldstat", __PNR_oldstat },
+	{ "olduname", __PNR_olduname },
+	{ "oldwait4", __PNR_oldwait4 },
+	{ "openat", 56 },
+	{ "open_by_handle_at", 265 },
+	{ "open", __PNR_open },
+	{ "pause", __PNR_pause },
+	{ "pciconfig_iobase", __PNR_pciconfig_iobase },
+	{ "pciconfig_read", __PNR_pciconfig_read },
+	{ "pciconfig_write", __PNR_pciconfig_write },
+	{ "perf_event_open", 241 },
+	{ "personality", 92 },
+	{ "pipe2", 59 },
+	{ "pipe", __PNR_pipe },
+	{ "pivot_root", 41 },
+	{ "pkey_alloc", 289 },
+	{ "pkey_free", 290 },
+	{ "pkey_mprotect", 288 },
+	{ "poll", __PNR_poll },
+	{ "ppoll", 73 },
+	{ "prctl", 167 },
+	{ "pread64", 67 },
+	{ "preadv2", 286 },
+	{ "preadv", 69 },
+	{ "prlimit64", 261 },
+	{ "process_vm_readv", 270 },
+	{ "process_vm_writev", 271 },
+	{ "profil", __PNR_profil },
+	{ "prof", __PNR_prof },
+	{ "pselect6", 72 },
+	{ "ptrace", 117 },
+	{ "putpmsg", __PNR_putpmsg },
+	{ "pwrite64", 68 },
+	{ "pwritev2", 287 },
+	{ "pwritev", 70 },
+	{ "query_module", __PNR_query_module },
+	{ "quotactl", 60 },
+	{ "read", 63 },
+	{ "readahead", 213 },
+	{ "readdir", __PNR_readdir },
+	{ "readlinkat", 78 },
+	{ "readlink", __PNR_readlink },
+	{ "readv", 65 },
+	{ "reboot", 142 },
+	{ "recvfrom", 207 },
+	{ "recvmmsg", 243 },
+	{ "recvmsg", 212 },
+	{ "recv", __PNR_recv },
+	{ "remap_file_pages", 234 },
+	{ "removexattr", 14 },
+	{ "renameat2", 276 },
+	{ "renameat", __PNR_renameat },
+	{ "rename", __PNR_rename },
+	{ "request_key", 218 },
+	{ "restart_syscall", 128 },
+	{ "riscv_flush_icache", 259 },
+	{ "rmdir", __PNR_rmdir },
+	{ "rtas", __PNR_rtas },
+	{ "rt_sigaction", 134 },
+	{ "rt_sigpending", 136 },
+	{ "rt_sigprocmask", 135 },
+	{ "rt_sigqueueinfo", 138 },
+	{ "rt_sigreturn", 139 },
+	{ "rt_sigsuspend", 133 },
+	{ "rt_sigtimedwait", 137 },
+	{ "rt_tgsigqueueinfo", 240 },
+	{ "s390_pci_mmio_read", __PNR_s390_pci_mmio_read },
+	{ "s390_pci_mmio_write", __PNR_s390_pci_mmio_write },
+	{ "s390_runtime_instr", __PNR_s390_runtime_instr },
+	{ "sched_getaffinity", 123 },
+	{ "sched_getattr", 275 },
+	{ "sched_getparam", 121 },
+	{ "sched_get_priority_max", 125 },
+	{ "sched_get_priority_min", 126 },
+	{ "sched_getscheduler", 120 },
+	{ "sched_rr_get_interval", 127 },
+	{ "sched_setaffinity", 122 },
+	{ "sched_setattr", 274 },
+	{ "sched_setparam", 118 },
+	{ "sched_setscheduler", 119 },
+	{ "sched_yield", 124 },
+	{ "seccomp", 277 },
+	{ "security", __PNR_security },
+	{ "select", __PNR_select },
+	{ "semctl", 191 },
+	{ "semget", 190 },
+	{ "semop", 193 },
+	{ "semtimedop", 192 },
+	{ "sendfile64", __PNR_sendfile64 },
+	{ "sendfile", 71 },
+	{ "sendmmsg", 269 },
+	{ "sendmsg", 211 },
+	{ "send", __PNR_send },
+	{ "sendto", 206 },
+	{ "setdomainname", 162 },
+	{ "setfsgid", 152 },
+	{ "setfsgid32", __PNR_setfsgid32 },
+	{ "setfsuid", 151 },
+	{ "setfsuid32", __PNR_setfsuid32 },
+	{ "setgid", 144 },
+	{ "setgid32", __PNR_setgid32 },
+	{ "setgroups", 159 },
+	{ "setgroups32", __PNR_setgroups32 },
+	{ "sethostname", 161 },
+	{ "setitimer", 103 },
+	{ "set_mempolicy", 237 },
+	{ "setns", 268 },
+	{ "setpgid", 154 },
+	{ "setpriority", 140 },
+	{ "setregid", 143 },
+	{ "setregid32", __PNR_setregid32 },
+	{ "setresgid", 149 },
+	{ "setresgid32", __PNR_setresgid32 },
+	{ "setresuid", 147 },
+	{ "setresuid32", __PNR_setresuid32 },
+	{ "setreuid", 145 },
+	{ "setreuid32", __PNR_setreuid32 },
+	{ "setrlimit", 164 },
+	{ "set_robust_list", 99 },
+	{ "setsid", 157 },
+	{ "setsockopt", 208 },
+	{ "set_thread_area", __PNR_set_thread_area },
+	{ "set_tid_address", 96 },
+	{ "settimeofday", 170 },
+	{ "set_tls", __PNR_set_tls },
+	{ "setuid", 146 },
+	{ "setuid32", __PNR_setuid32 },
+	{ "setxattr", 5 },
+	{ "sgetmask", __PNR_sgetmask },
+	{ "shmat", 196 },
+	{ "shmctl", 195 },
+	{ "shmdt", 197 },
+	{ "shmget", 194 },
+	{ "shutdown", 210 },
+	{ "sigaction", __PNR_sigaction },
+	{ "sigaltstack", 132 },
+	{ "signalfd4", 74 },
+	{ "signalfd", __PNR_signalfd },
+	{ "signal", __PNR_signal },
+	{ "sigpending", __PNR_sigpending },
+	{ "sigprocmask", __PNR_sigprocmask },
+	{ "sigreturn", __PNR_sigreturn },
+	{ "sigsuspend", __PNR_sigsuspend },
+	{ "socket", 198 },
+	{ "socketcall", __PNR_socketcall },
+	{ "socketpair", 199 },
+	{ "splice", 76 },
+	{ "spu_create", __PNR_spu_create },
+	{ "spu_run", __PNR_spu_run },
+	{ "ssetmask", __PNR_ssetmask },
+	{ "stat64", __PNR_stat64 },
+	{ "statfs", 43 },
+	{ "statfs64", __PNR_statfs64 },
+	{ "stat", __PNR_stat },
+	{ "stime", __PNR_stime },
+	{ "stty", __PNR_stty },
+	{ "subpage_prot", __PNR_subpage_prot },
+	{ "swapcontext", __PNR_swapcontext },
+	{ "swapoff", 225 },
+	{ "swapon", 224 },
+	{ "switch_endian", __PNR_switch_endian },
+	{ "symlinkat", 36 },
+	{ "symlink", __PNR_symlink },
+	{ "sync", 81 },
+	{ "sync_file_range2", __PNR_sync_file_range2 },
+	{ "sync_file_range", 84 },
+	{ "syncfs", 267 },
+	{ "syscall", __PNR_syscall },
+	{ "_sysctl", __PNR__sysctl },
+	{ "sys_debug_setcontext", __PNR_sys_debug_setcontext },
+	{ "sysfs", __PNR_sysfs },
+	{ "sysinfo", 179 },
+	{ "syslog", 116 },
+	{ "sysmips", __PNR_sysmips },
+	{ "tee", 77 },
+	{ "tgkill", 131 },
+	{ "time", __PNR_time },
+	{ "timer_create", 107 },
+	{ "timer_delete", 111 },
+	{ "timerfd_create", 85 },
+	{ "timerfd_gettime", 87 },
+	{ "timerfd", __PNR_timerfd },
+	{ "timerfd_settime", 86 },
+	{ "timer_getoverrun", 109 },
+	{ "timer_gettime", 108 },
+	{ "timer_settime", 110 },
+	{ "times", 153 },
+	{ "tkill", 130 },
+	{ "truncate", 45 },
+	{ "truncate64", __PNR_truncate64 },
+	{ "tuxcall", __PNR_tuxcall },
+	{ "ugetrlimit", __PNR_ugetrlimit },
+	{ "ulimit", __PNR_ulimit },
+	{ "umask", 166 },
+	{ "umount2", 39 },
+	{ "umount", __PNR_umount },
+	{ "uname", 160 },
+	{ "unlinkat", 35 },
+	{ "unlink", __PNR_unlink },
+	{ "unshare", 97 },
+	{ "uselib", __PNR_uselib },
+	{ "userfaultfd", 282 },
+	{ "usr26", __PNR_usr26 },
+	{ "usr32", __PNR_usr32 },
+	{ "ustat", __PNR_ustat },
+	{ "utimensat", 88 },
+	{ "utime", __PNR_utime },
+	{ "utimes", __PNR_utimes },
+	{ "vfork", __PNR_vfork },
+	{ "vhangup", 58 },
+	{ "vm86old", __PNR_vm86old },
+	{ "vm86", __PNR_vm86 },
+	{ "vmsplice", 75 },
+	{ "vserver", __PNR_vserver },
+	{ "wait4", 260 },
+	{ "waitid", 95 },
+	{ "waitpid", __PNR_waitpid },
+	{ "write", 64 },
+	{ "writev", 66 },
diff -Naur libseccomp-2.3.2-old/tools/util.c libseccomp-2.3.2/tools/util.c
--- libseccomp-2.3.2-old/tools/util.c	2017-02-28 06:24:22.638360424 +0800
+++ libseccomp-2.3.2/tools/util.c	2018-02-20 19:06:00.849257606 +0800
@@ -70,6 +70,11 @@
 #endif
 #elif __PPC__
 #define ARCH_NATIVE		AUDIT_ARCH_PPC
+#elif __riscv && __riscv_xlen == 64
+/* kernel audit support for riscv is not yet ready */
+#define EM_RISCV		243
+#define AUDIT_ARCH_AARCH64	(EM_AARCH64|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)
+#define ARCH_NATIVE		AUDIT_ARCH_AARCH64
 #elif __s390x__ /* s390x must be checked before s390 */
 #define ARCH_NATIVE		AUDIT_ARCH_S390X
 #elif __s390__
